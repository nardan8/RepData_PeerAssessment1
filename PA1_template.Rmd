---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,  fig.path = 'figure/', fig.cap = '  ', fig.pos = "H")
```


## Loading and preprocessing the data
```{r load-preprocess-data, message=FALSE}
library(dplyr)
library(ggplot2)
zipFile <- "activity.zip"
filename <- "activity.csv"

# unzip if file doesn't already exist
if (!file.exists(filename)) {
        unzip(zipFile)
}

# read data
df <- read.csv(filename)

# convert Date type
df <- mutate(df, date = as.Date(date, "%Y-%m-%d"))
```


## What is mean total number of steps taken per day?
1. Calculate the total number of steps taken per day
```{r message=FALSE}
# group by days
groupedDf <- group_by(df, date)

# sum steps of each day
stepsPerDay <- summarise(groupedDf, steps = sum(steps, na.rm = TRUE))
```
2. Make a histogram of the total number of steps taken each day
``` {r figure2}
ggplot(stepsPerDay, aes(x=date, y=steps)) + 
        geom_bar(stat = "identity", color = "black", fill = "steelblue") + 
        labs(title = "Total number of steps taken each day", x = "Date", y = "Total step counts")
```

3. Calculate and report the mean and median of the total number of steps taken per day
``` {r}
stepsMean <- summarise(stepsPerDay, stepsMean = round(mean(steps, na.rm = TRUE), 0))
stepsMedian <- summarise(stepsPerDay, stepsMedian = median(steps, na.rm = TRUE))
```
The Mean value of the number of steps taken per day is - `r stepsMean` steps.  
The Median value of the number of steps taken per day is - `r stepsMedian` steps.



## What is the average daily activity pattern?
1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r message=FALSE, warning=FALSE}
# group data by 5 minute interval
groupByInterval <- group_by(df, interval)

# remove NA rows
groupByInterval <- filter(groupByInterval, !is.na(steps))

# summarise average value of each time interval
groupByInterval <- groupByInterval %>% summarise(averageSteps = mean(steps))
```
``` {r figure}
# construct graph
qplot(x = interval, 
      y = averageSteps, 
      data = groupByInterval,
      geom = "line",
      ylab = "Averaged steps count", 
      xlab = "5-minute time interval")
```

2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
# max average 5-minute interval steps count
maxSteps <- groupByInterval[which.max(groupByInterval$averageSteps),]
maxInterval <- sub("(?<=.{2})", ":", sprintf("%04d", maxSteps$interval), perl = TRUE)
```
The "`r maxInterval`" is 5-minute interval, on average across all the days in the dataset, which contains max number of steps - `r maxSteps$averageSteps`.


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
